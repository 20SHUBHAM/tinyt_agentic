<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agentic Focus Group System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <header class="bg-primary text-white py-4 mb-4">
            <div class="container">
                <h1 class="mb-0">
                    <i class="fas fa-users me-2"></i>
                    Agentic Focus Group System
                </h1>
                <p class="mb-0 mt-2">Complete end-to-end automation for TinyTroupe focus group discussions</p>
            </div>
        </header>

        <!-- Stepper -->
        <div class="container mt-n3">
            <ul class="progress-steps mb-4">
                <li id="step-indicator-0" class="active">
                    <span class="step-index">0</span>
                    <span class="step-label">Plan</span>
                </li>
                <li id="step-indicator-1">
                    <span class="step-index">1</span>
                    <span class="step-label">Personas</span>
                </li>
                <li id="step-indicator-2">
                    <span class="step-index">2</span>
                    <span class="step-label">Edit</span>
                </li>
                <li id="step-indicator-3">
                    <span class="step-index">3</span>
                    <span class="step-label">Discussion</span>
                </li>
                <li id="step-indicator-4">
                    <span class="step-index">4</span>
                    <span class="step-label">Results</span>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="container">
            <!-- Step 0: Plan Generation & Edit -->
            <div class="card mb-4" id="step0-card">
                <div class="card-header bg-secondary text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-list-check me-2"></i>
                        Step 0: Generate Discussion Plan
                    </h3>
                </div>
                <div class="card-body">
                    <form id="plan-form">
                        <div class="mb-3">
                            <label for="topic-brief" class="form-label">
                                <strong>Topic Brief</strong>
                                <small class="text-muted">(Write a short description of what you want to study)</small>
                            </label>
                            <textarea class="form-control" id="topic-brief" rows="3" placeholder="Example: Gen Z online cosmetics shopping experiences, trust in platforms, budget behaviors, and influencer impact."></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="generated-plan" class="form-label"><strong>Generated Plan (editable)</strong></label>
                            <textarea class="form-control" id="generated-plan" rows="8" placeholder="Plan will appear here..."></textarea>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-secondary" id="generate-plan-btn">
                                <i class="fas fa-wand-magic-sparkles me-2"></i>
                                Generate Plan
                            </button>
                            <button type="button" class="btn btn-primary" id="accept-plan-btn">
                                <i class="fas fa-check me-2"></i>
                                Accept Plan & Continue
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Step 1: Persona Generation -->
            <div class="card mb-4" id="step1-card">
                <div class="card-header bg-info text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-user-plus me-2"></i>
                        Step 1: Generate TinyPersons
                    </h3>
                </div>
                <div class="card-body">
                    <form id="persona-form">
                        <div class="mb-3">
                            <label for="context-prompt" class="form-label">
                                <strong>Context Prompt</strong>
                                <small class="text-muted">(Describe what type of TinyPersons you want)</small>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="context-prompt" 
                                rows="4" 
                                placeholder="Example: I want to create a diverse group of Gen Z consumers aged 18-25 from urban India who are active on social media and interested in beauty/cosmetics. Include different personality types like enthusiastic early adopters, budget-conscious researchers, and trend-following influencer watchers."
                                required
                            ></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="discussion-topic" class="form-label">
                                <strong>Discussion Topic</strong>
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="discussion-topic" 
                                placeholder="Example: Online beauty shopping experiences and preferences"
                                required
                            />
                        </div>
                        <button type="submit" class="btn btn-info btn-lg">
                            <i class="fas fa-magic me-2"></i>
                            Generate Personas
                        </button>
                    </form>
                </div>
            </div>

            <!-- Step 2: Review and Edit Personas -->
            <div class="card mb-4 d-none" id="step2-card">
                <div class="card-header bg-warning text-dark">
                    <h3 class="mb-0">
                        <i class="fas fa-edit me-2"></i>
                        Step 2: Review & Edit Personas
                    </h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong>Personas Generated!</strong> Review the generated personas and topic below. You can edit them if needed.
                    </div>
                    
                    <div class="mb-4">
                        <label for="edit-topic" class="form-label"><strong>Discussion Topic:</strong></label>
                        <input type="text" class="form-control" id="edit-topic" />
                    </div>

                    <div id="personas-container" class="mb-4">
                        <!-- Personas will be dynamically loaded here -->
                    </div>

                    <div class="d-flex gap-2">
                        <button class="btn btn-warning" id="update-personas-btn">
                            <i class="fas fa-save me-2"></i>
                            Update Personas & Topic
                        </button>
                        <button class="btn btn-success btn-lg" id="start-discussion-btn">
                            <i class="fas fa-play me-2"></i>
                            Start Discussion
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: Discussion Progress -->
            <div class="card mb-4 d-none" id="step3-card">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-comments me-2"></i>
                        Step 3: Discussion in Progress
                    </h3>
                </div>
                <div class="card-body text-center">
                    <div class="spinner-border text-success mb-3" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h4>Focus Group Discussion Running...</h4>
                    <p class="text-muted mb-4">Our AI agents are conducting the discussion with your generated personas. This may take a few minutes.</p>
                    
                    <div class="progress mb-3">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                    </div>
                    
                    <div id="discussion-status" class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Initializing discussion...
                    </div>
                </div>
            </div>

            <!-- Step 4: Results and Q&A -->
            <div class="card mb-4 d-none" id="step4-card">
                <div class="card-header bg-dark text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-chart-line me-2"></i>
                        Step 4: Discussion Results & Q&A
                    </h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong>Discussion Complete!</strong> Summary has been automatically generated.
                    </div>

                    <!-- Tabs for Results -->
                    <ul class="nav nav-tabs mb-3" id="results-tabs">
                        <li class="nav-item">
                            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#summary-tab">
                                <i class="fas fa-file-alt me-1"></i>Summary
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#transcript-tab">
                                <i class="fas fa-comments me-1"></i>Transcript
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#qa-tab">
                                <i class="fas fa-question-circle me-1"></i>Q&A
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <!-- Summary Tab -->
                        <div class="tab-pane fade show active" id="summary-tab">
                            <div id="summary-content">
                                <!-- Summary will be loaded here -->
                            </div>
                        </div>

                        <!-- Transcript Tab -->
                        <div class="tab-pane fade" id="transcript-tab">
                            <div id="transcript-content" style="max-height: 600px; overflow-y: auto;">
                                <!-- Transcript will be loaded here -->
                            </div>
                        </div>

                        <!-- Q&A Tab -->
                        <div class="tab-pane fade" id="qa-tab">
                            <div class="row">
                                <div class="col-md-8">
                                    <div id="qa-conversation" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; background-color: #f8f9fa;">
                                        <div class="text-muted text-center">
                                            <i class="fas fa-robot me-2"></i>
                                            Ask any question about the focus group discussion!
                                        </div>
                                    </div>
                                    
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="qa-question" placeholder="Ask a question about the discussion...">
                                        <button class="btn btn-primary" id="ask-question-btn">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0">
                                                <i class="fas fa-lightbulb me-1"></i>
                                                Suggested Questions
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="suggested-questions">
                                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 suggested-question">What were the main themes discussed?</button>
                                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 suggested-question">What drives purchasing decisions for this group?</button>
                                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 suggested-question">What were the main barriers mentioned?</button>
                                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 suggested-question">How did different personality types respond?</button>
                                                <button class="btn btn-outline-secondary btn-sm mb-2 w-100 suggested-question">What opportunities were identified?</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading Overlay -->
            <div class="loading-overlay d-none" id="loading-overlay">
                <div class="loading-content">
                    <div class="spinner-border text-primary mb-3" style="width: 3rem; height: 3rem;"></div>
                    <h4>Processing...</h4>
                    <p class="text-muted" id="loading-message">Please wait while we process your request.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="/static/js/app.js"></script>
</body>
</html>